<!DOCTYPE html>
<html lang="ko"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{view/layout/layout}">
<head>
    <title>게시글 상세보기</title>
    <th:block layout:fragment="script">
        <script src="/js/postDetail.js" type="module" defer></script>
    </th:block>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.22/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
<div layout:fragment="content" class="container w-full max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg">
    <main>
        <div class="post-detail">
            <!-- 게시글 ID (숨김 처리) -->
            <div id="postId" hidden="hidden" th:text="${postDetail.postId}">0</div>

            <!-- 게시글 제목 -->
            <h1 th:text="${postDetail.title}" class="text-3xl font-bold mb-4">Post Title</h1>
            <a th:href="@{/choose/{id}(id=${postDetail.postId})}" class="btn btn-secondary btn-sm mb-6">
                간택하기
            </a>

            <!-- 게시글 작성자 및 작성 시간 -->
            <div class="post-info flex items-center text-gray-600 mb-6">
                <span th:text="${postDetail.author}" class="mr-4">작성자</span>
                <span th:text="${#temporals.format(postDetail.createdAt, 'yyyy-MM-dd HH:mm')}">작성 시간</span>
            </div>

            <!-- 게시글 내용 -->
            <div class="post-content mb-6">
                <p th:text="${postDetail.text}" class="text-gray-700 leading-relaxed">본문 내용</p>
            </div>

            <!-- 게시글 설명 -->
            <div class="post-description mb-6">
                <p th:text="${postDetail.description}" class="text-gray-600 italic">설명 내용</p>
            </div>

            <!-- 액션 버튼들 -->
            <div class="actions flex items-center space-x-4 mb-8">
                <button id="likeButton" class="btn btn-outline btn-success btn-sm">
                    👍 <span id="likeCount" th:text="${postDetail.likeCount}"></span>
                </button>
            </div>

            <!-- 댓글 입력 폼 -->
            <div class="comment-form mb-8">
                <form th:action="@{/post/comment/{id}(id=${postDetail.postId})}" method="post" class="space-y-4">
                    <textarea name="content" placeholder="Add a Comment" required
                              class="textarea textarea-bordered w-full bg-white"></textarea>
                    <button type="submit" class="btn btn-primary w-full">댓글 등록</button>
                </form>
            </div>

            <!-- 댓글 목록 -->
            <div class="comment-list">
                <h2 class="text-2xl font-semibold mb-4">댓글 목록</h2>
                <ul class="space-y-6">
                    <!-- 댓글이 있는 경우 출력 -->
                    <li class="comment-item bg-gray-100 p-4 rounded-lg shadow-sm"
                        th:each="comment : ${postDetail.comments}" th:if="${postDetail.comments.size() > 0}"
                        th:attr="data-comment-id=${comment.getCommentId()}">
                        <div>
                            <div id="commentId" hidden="hidden" th:text="${comment.getCommentId()}"></div>
                            <p class="comment-author font-bold text-gray-700 mb-2" th:text="${comment.member.nickname}">작성자</p>
                            <p class="comment-content text-gray-600 mb-2" th:text="${comment.content}">댓글 내용</p>
                            <p class="comment-date text-sm text-gray-500" th:text="${#temporals.format(comment.createdAt, 'yyyy-MM-dd HH:mm')}">작성 시간</p>
                            <div class="comment-actions flex space-x-4 mt-2">
                                <!-- 수정 버튼 -->
                                <button class="btn btn-primary btn-sm edit-comment-btn"
                                        th:attr="data-comment-id=${comment.getCommentId()}">수정</button>
                                <!-- 삭제 버튼 -->
                                <button class="btn btn-primary btn-sm delete-comment-btn"
                                        th:attr="data-comment-id=${comment.getCommentId()}">삭제</button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </main>
</div>
</body>
</html>
